<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Models [mlpp.optim.model] &#8212; MLPP 0.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="MLPP 0.1 documentation" href="../index.html" />
    <link rel="next" title="Proximal operators [mlpp.optim.prox]" href="prox.html" />
    <link rel="prev" title="Presentation" href="optimization_toolbox.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">MLPP 0.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="optimization_toolbox.html" title="Presentation"
             accesskey="P">previous</a> |
          <a href="prox.html" title="Proximal operators [mlpp.optim.prox]"
             accesskey="N">next</a> |
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="models-mlpp-optim-model">
<h1>Models [<code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model</span></code>]<a class="headerlink" href="#models-mlpp-optim-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In <code class="xref py py-obj docutils literal"><span class="pre">MLPP</span></code> a <code class="xref py py-obj docutils literal"><span class="pre">Model</span></code> class gives information about a statistical model.
Depending on the case, it gives first order information (loss, gradient) or
second order information (hessian norm evaluation).</p>
<p>For now, we have two families of models: Generalized Linear Models and
Hawkes models.</p>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="#generalized-linear-models"><span class="std std-ref">Generalized linear models</span></a></li>
<li><a class="reference internal" href="#model-hawkes"><span class="std std-ref">Hawkes model</span></a></li>
</ul>
</div>
<div class="section" id="generalized-linear-models">
<span id="id1"></span><h2>Generalized linear models<a class="headerlink" href="#generalized-linear-models" title="Permalink to this headline">¶</a></h2>
<p>[Classes from <code class="xref py py-obj docutils literal"><span class="pre">mlpp.optim.model</span></code>]</p>
<div class="section" id="id2">
<h3>Introduction<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>We describe here linear generalized models for supervised learning.
Given training data <span class="math">\((x_i, y_i) \in \mathbb R^d \times \mathbb R\)</span>
for <span class="math">\(i=1, \ldots, n\)</span>, we consider models with a goodness-of fit-that
writes</p>
<div class="math">
\[f(\theta) = \frac 1n \sum_{i=1}^n \ell(y_i, b + x_i^\top \theta),\]</div>
<p>where <span class="math">\(\theta \in \mathbb R^d\)</span> is a vector containing coefficients
to be learned, <span class="math">\(b \in \mathbb R\)</span> is the intercept and
<span class="math">\(\ell : \mathbb R^2 \rightarrow \mathbb R\)</span> is a loss function.
The loss function depends on the model. The following table describes the
different losses implemented in <code class="docutils literal"><span class="pre">MLPP</span></code> and its associated class :</p>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="33%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Model</th>
<th class="head">Loss formula</th>
<th class="head">Class</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="model/linreg.html#model-linreg"><span class="std std-ref">Linear regression model</span></a></td>
<td><span class="math">\(\ell(y, z) = \frac 12 (y - z)^2\)</span></td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelLinReg</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="model/logreg.html#model-logreg"><span class="std std-ref">Logistic regression model</span></a></td>
<td><span class="math">\(\ell(y, z) = \log(1 + \exp(-y z))\)</span></td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelLogReg</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="model/poisreg.html#model-poisreg"><span class="std std-ref">Poisson regression model</span></a> with exponential link</td>
<td>&nbsp;</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelPoisReg</span></code> with <code class="docutils literal"><span class="pre">link=&quot;exponential&quot;</span></code></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="model/poisreg.html#model-poisreg"><span class="std std-ref">Poisson regression model</span></a> with identity link</td>
<td>&nbsp;</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelPoisReg</span></code> with <code class="docutils literal"><span class="pre">link=&quot;identity&quot;</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="model/coxreg-partial-lik.html#coxreg-partial-lik"><span class="std std-ref">Cox regression with partial likelihood model</span></a></td>
<td>&nbsp;</td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelCoxRegPartialLik</span></code></td>
</tr>
</tbody>
</table>
<p>All model classes allow to compute the loss, the gradient and eventually some
second order informations about the model, see the classes below.
All classes can be used with any solver, by passing them with a solver&#8217;s <code class="docutils literal"><span class="pre">set_model</span></code>
method.</p>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The next example shows how to create a Logistic regression model from
simulated data, and how to use it with a solver (here we use
<code class="xref py py-obj docutils literal"><span class="pre">Fista</span></code>, even if it&#8217;s certainly not a good choice):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mlpp.simulation</span> <span class="k">import</span> <span class="n">SimuLogReg</span><span class="p">,</span> <span class="n">coeffs_sparse_gauss</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.model</span> <span class="k">import</span> <span class="n">ModelLogReg</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.solver</span> <span class="k">import</span> <span class="n">Fista</span>
<span class="kn">from</span> <span class="nn">mlpp.optim.prox</span> <span class="k">import</span> <span class="n">ProxZero</span>

<span class="n">n_samples</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">,</span>
<span class="n">n_features</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Ground truth coefficients</span>
<span class="n">coeffs0</span> <span class="o">=</span> <span class="n">coeffs_sparse_gauss</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span><span class="p">,</span> <span class="n">nnz</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># Ground truth intercept</span>
<span class="n">interc0</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1"># Simulation of data: X contains the features matrix and y the labels</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">SimuLogReg</span><span class="p">(</span><span class="n">coeffs0</span><span class="p">,</span> <span class="n">interc</span><span class="o">=</span><span class="n">interc0</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span><span class="o">.</span><span class="n">simulate</span><span class="p">()</span>

<span class="c1"># Create a logistic regression model, and pass the data to it</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ModelLogReg</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="c1"># Show a JSON description of the object</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1"># No penalization is used</span>
<span class="n">prox</span> <span class="o">=</span> <span class="n">ProxZero</span><span class="p">()</span>
<span class="c1"># Create a solver, pass to it the model and the penalization</span>
<span class="n">fista</span> <span class="o">=</span> <span class="n">Fista</span><span class="p">()</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">set_prox</span><span class="p">(</span><span class="n">prox</span><span class="p">)</span>

<span class="c1"># Launch the solver</span>
<span class="n">coeffs</span> <span class="o">=</span> <span class="n">fista</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hawkes-model">
<span id="model-hawkes"></span><h2>Hawkes model<a class="headerlink" href="#hawkes-model" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Introduction<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Model</th>
<th class="head">Class</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="model/hawkes_loglik_exp.html#model-hawkes-exp"><span class="std std-ref">Hawkes likelihood model with exponential kernels and with decrease</span></a></td>
<td><code class="xref py py-obj docutils literal"><span class="pre">ModelHawkesFixedExpKernLogLik</span></code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="what-s-under-the-hood">
<h2>What&#8217;s under the hood?<a class="headerlink" href="#what-s-under-the-hood" title="Permalink to this headline">¶</a></h2>
<p>All model classes have a <code class="docutils literal"><span class="pre">loss</span></code> and <code class="docutils literal"><span class="pre">grad</span></code> method, that are used by batch
algorithms to fit the model. These classes contains a C++ object, that does the
computations. Some methods are hidden within this C++ object, and are accessible
only through C++ (such as <code class="docutils literal"><span class="pre">loss_i</span></code> and <code class="docutils literal"><span class="pre">grad_i</span></code> that compute the gradient
using the single data point <span class="math">\((x_i, y_i)\)</span>). These hidden methods are used
in the stochastic solvers, and are available through C++ only for efficiency.
These methods are described in the C++ documentation here
(TODO: add the link to doxygen)</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/simulation/poisson_process_simulation.html">Poisson processes simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/simulation/hawkes_simulation.html">Hawkes processes simulation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/inference/hawkes_non_parametric.html">Hawkes non parametric inference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/optimization/stochastic_solver.html">Stochastic solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/optimization/linear_model.html">Generalized linear models</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../z_tutorials/misc/time_function.html">Time functions</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="optimization_toolbox.html">Presentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models [<code class="docutils literal"><span class="pre">mlpp.optim.model</span></code>]</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generalized-linear-models">Generalized linear models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hawkes-model">Hawkes model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-s-under-the-hood">What&#8217;s under the hood?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prox.html">Proximal operators [<code class="docutils literal"><span class="pre">mlpp.optim.prox</span></code>]</a></li>
<li class="toctree-l1"><a class="reference internal" href="solver.html">Solvers [<code class="docutils literal"><span class="pre">mlpp.optim.solver</span></code>]</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simu/simu.html">Simulation toolbox [<code class="docutils literal"><span class="pre">mlpp.simulation</span></code>]</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/dev.html">Developer documentation</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="optimization_toolbox.html" title="Presentation"
              >previous</a> |
            <a href="prox.html" title="Proximal operators [mlpp.optim.prox]"
              >next</a> |
            <a href="../py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/optim/model.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Emmanuel Bacry, Martin Bompaire, Stephane Gaiffas, Maryan Morel, Søren Poulsen.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>